---
import { wpquery } from "../functions/wpress";
import Layout from "../layouts/Layout.astro";
import Header from "../components/Header.astro";
import FeaturePostSlider from "../components/FeaturePostSlider.astro";

const data = await wpquery({
    query: `
    query HomePage($uri: String = "$uri") {
        nodeByUri(uri: $uri) {
            ... on Page {
                slug
                title
                seo {
                    fullHead
                }
                blocks {
                    name
                    order
                    originalContent
                    isDynamic
                    dynamicContent
                    attributesJSON
                }
            }
        }
        globalStylesheet
    }
    `,
    variables: { uri: "/" },
});

const { nodeByUri, globalStylesheet } = data;
const { title, seo, blocks } = nodeByUri;
---

<Layout inlineCss={globalStylesheet} seoFullHead={seo.fullHead}>
    <Header />
    <FeaturePostSlider />
    <section class="container mx-auto max-w-screen-xl px-4">
        <main class="py-12">
            <h1 class="text-4xl font-bold">{title}</h1>
            <div class="mt-8">
                {
                    blocks.map((block: any) =>
                        block.isDynamic ? (
                            <Fragment set:html={block.dynamicContent} />
                        ) : (
                            <Fragment set:html={block.originalContent} />
                        ),
                    )
                }
            </div>
        </main>
    </section>
</Layout>
